{% if site.post_search %}

<div id="beautifuljekyll-search-overlay">
  <div id="nav-search-exit" title="Exit search" role="button" tabindex="0">âœ•</div>
  <input type="text" id="nav-search-input" placeholder="Search posts..." aria-label="Search blog posts">
  <ul id="search-results-container" role="listbox" aria-label="Search results"></ul>
  <div id="no-search-results" class="search-no-results" hidden>No results found</div>
    <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
    (function() {
      var searchInput = document.getElementById('nav-search-input');
      var resultsContainer = document.getElementById('search-results-container');
      var noResultsDiv = document.getElementById('no-search-results');
      
      // Initialize search with custom results handling
      SimpleJekyllSearch({
        searchInput: searchInput,
        resultsContainer: resultsContainer,
        json: '{{ site.baseurl }}/assets/data/searchcorpus.json',
        searchResultTemplate: '<li role="option"><a href="{url}" class="search-result-link"><div class="search-result-title">{title}</div><div class="search-result-snippet">{snippet}</div></a></li>',
        noResultsText: '',
        limit: 10,
        fuzzy: false,
        exclude: ['Welcome'],
        searchResultCallback: function(results) {
          if (!results || results.length === 0) {
            noResultsDiv.hidden = false;
            resultsContainer.hidden = true;
          } else {
            noResultsDiv.hidden = true;
            resultsContainer.hidden = false;
          }
        }
      });

      // Clear results and hide no-results message when closing search
      document.getElementById('nav-search-exit').addEventListener('click', function() {
        searchInput.value = '';
        resultsContainer.innerHTML = '';
        noResultsDiv.hidden = true;
        resultsContainer.hidden = false;
      });

      // Hide overlay on escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          searchInput.value = '';
          resultsContainer.innerHTML = '';
          noResultsDiv.hidden = true;
          resultsContainer.hidden = false;
        }
      });
    })();
  </script>
</div>

{% endif %}
