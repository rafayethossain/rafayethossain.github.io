{% if site.post_search %}

<div id="beautifuljekyll-search-overlay">
  <div id="nav-search-exit" title="Exit search">âœ•</div>
  <input type="text" id="nav-search-input" placeholder="Search" aria-label="Search blog posts">
  <ul id="search-results-container" role="listbox" aria-label="Search results"></ul>
  <div id="no-search-results" hidden>No results found</div>
  
  <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
      
      // Initialize search
      var search = SimpleJekyllSearch({
        searchInput: searchInput,
        resultsContainer: resultsContainer,
        json: '{{ site.baseurl }}/assets/data/searchcorpus.json',
        searchResultTemplate: '<li role="option"><a href="{url}" class="search-result-link"><div class="search-result-title">{title}</div><div class="search-result-snippet">{snippet}</div></a></li>',
        noResultsText: '',
        limit: 10,
        fuzzy: false,
        exclude: ['Welcome']
      });

      // Show overlay when search button is clicked
      if (searchButton) {
        searchButton.addEventListener('click', function() {
          searchOverlay.classList.add('is-active');
          document.body.classList.add('search-active');
          searchInput.focus();
          searchButton.setAttribute('aria-expanded', 'true');
        });
      }

      // Close overlay when close button is clicked
      if (closeButton) {
        closeButton.addEventListener('click', function() {
          closeSearchOverlay();
        });
      }

      // Close overlay when Escape key is pressed
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && searchOverlay.classList.contains('is-active')) {
          closeSearchOverlay();
        }
      });

      // Close overlay when clicking outside
      searchOverlay.addEventListener('click', function(e) {
        if (e.target === searchOverlay) {
          closeSearchOverlay();
        }
      });

      function closeSearchOverlay() {
        searchOverlay.classList.remove('is-active');
        document.body.classList.remove('search-active');
        searchButton.setAttribute('aria-expanded', 'false');
        searchInput.value = '';
        resultsContainer.innerHTML = '';
        noResults.hidden = true;
      }

      // Handle no results
      searchInput.addEventListener('input', function() {
        setTimeout(function() {
          if (resultsContainer.children.length === 0) {
            noResults.hidden = false;
          } else {
            noResults.hidden = true;
          }
        }, 100);
      });
    })();
  </script>
</div>

{% endif %}
